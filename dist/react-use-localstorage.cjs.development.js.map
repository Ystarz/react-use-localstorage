{"version":3,"file":"react-use-localstorage.cjs.development.js","sources":["../src/index.ts"],"sourcesContent":["import { Dispatch, useCallback, useEffect, useState } from 'react';\n\nconst isJson = (s: any) => {\n  if (!s) return false;\n\n  try {\n    var o = JSON.parse(s);\n    if (o && typeof o === 'object') return true;\n  } catch (e) {}\n\n  return false;\n};\n\nexport default function useLocalStorage(\n  key: string,\n  initialValue: any = ''\n): [any, Dispatch<string>] {\n  if (!window.localStorage.getItem(key)) {\n    if (typeof (initialValue) == 'object')\n      window.localStorage.setItem(key, JSON.stringify(initialValue));\n    else window.localStorage.setItem(key, initialValue);\n  }\n\n  const [value, setValue] = useState(() => {\n    const i = window.localStorage.getItem(key);\n\n    if (i && isJson(i)) return JSON.parse(i);\n    else return i;\n  });\n\n  const setItem = (newValue: any) => {\n    setValue(newValue);\n\n    if (typeof (newValue) == 'object')\n      return window.localStorage.setItem(key, JSON.stringify(newValue));\n    else window.localStorage.setItem(key, newValue);\n  };\n\n  useEffect(() => {\n    const newValue = window.localStorage.getItem(key);\n    if (value !== newValue) {\n      setValue(newValue || initialValue);\n    }\n  });\n\n  const handleStorage = useCallback(\n    (event: StorageEvent) => {\n      if (event.key === key && event.newValue !== value) {\n        setValue(event.newValue || initialValue);\n      }\n    },\n    [value]\n  );\n\n  useEffect(() => {\n    window.addEventListener('storage', handleStorage);\n    return () => window.removeEventListener('storage', handleStorage);\n  }, [handleStorage]);\n\n  return [value, setItem];\n}\n"],"names":["isJson","s","o","JSON","parse","e","useLocalStorage","key","initialValue","window","localStorage","getItem","setItem","stringify","useState","i","value","setValue","newValue","useEffect","handleStorage","useCallback","event","addEventListener","removeEventListener"],"mappings":";;;;;;AAEA,IAAMA,MAAM,GAAG,SAATA,MAAS,CAACC,CAAD;AACb,MAAI,CAACA,CAAL,EAAQ,OAAO,KAAP;;AAER,MAAI;AACF,QAAIC,CAAC,GAAGC,IAAI,CAACC,KAAL,CAAWH,CAAX,CAAR;AACA,QAAIC,CAAC,IAAI,OAAOA,CAAP,KAAa,QAAtB,EAAgC,OAAO,IAAP;AACjC,GAHD,CAGE,OAAOG,CAAP,EAAU;;AAEZ,SAAO,KAAP;AACD,CATD;;SAWwBC,gBACtBC,KACAC;MAAAA;AAAAA,IAAAA,eAAoB;;;AAEpB,MAAI,CAACC,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4BJ,GAA5B,CAAL,EAAuC;AACrC,QAAI,QAAQC,YAAY,IAAI,QAAxB,CAAJ,EACEC,MAAM,CAACC,YAAP,CAAoBE,OAApB,CAA4BL,GAA5B,EAAiCJ,IAAI,CAACU,SAAL,CAAeL,YAAf,CAAjC,EADF,KAEKC,MAAM,CAACC,YAAP,CAAoBE,OAApB,CAA4BL,GAA5B,EAAiCC,YAAjC;AACN;;kBAEyBM,cAAQ,CAAC;AACjC,QAAMC,CAAC,GAAGN,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4BJ,GAA5B,CAAV;AAEA,QAAIQ,CAAC,IAAIf,MAAM,CAACe,CAAD,CAAf,EAAoB,OAAOZ,IAAI,CAACC,KAAL,CAAWW,CAAX,CAAP,CAApB,KACK,OAAOA,CAAP;AACN,GALiC;MAA3BC;MAAOC;;AAOd,MAAML,OAAO,GAAG,SAAVA,OAAU,CAACM,QAAD;AACdD,IAAAA,QAAQ,CAACC,QAAD,CAAR;AAEA,QAAI,QAAQA,QAAQ,IAAI,QAApB,CAAJ,EACE,OAAOT,MAAM,CAACC,YAAP,CAAoBE,OAApB,CAA4BL,GAA5B,EAAiCJ,IAAI,CAACU,SAAL,CAAeK,QAAf,CAAjC,CAAP,CADF,KAEKT,MAAM,CAACC,YAAP,CAAoBE,OAApB,CAA4BL,GAA5B,EAAiCW,QAAjC;AACN,GAND;;AAQAC,EAAAA,eAAS,CAAC;AACR,QAAMD,QAAQ,GAAGT,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4BJ,GAA5B,CAAjB;;AACA,QAAIS,KAAK,KAAKE,QAAd,EAAwB;AACtBD,MAAAA,QAAQ,CAACC,QAAQ,IAAIV,YAAb,CAAR;AACD;AACF,GALQ,CAAT;AAOA,MAAMY,aAAa,GAAGC,iBAAW,CAC/B,UAACC,KAAD;AACE,QAAIA,KAAK,CAACf,GAAN,KAAcA,GAAd,IAAqBe,KAAK,CAACJ,QAAN,KAAmBF,KAA5C,EAAmD;AACjDC,MAAAA,QAAQ,CAACK,KAAK,CAACJ,QAAN,IAAkBV,YAAnB,CAAR;AACD;AACF,GAL8B,EAM/B,CAACQ,KAAD,CAN+B,CAAjC;AASAG,EAAAA,eAAS,CAAC;AACRV,IAAAA,MAAM,CAACc,gBAAP,CAAwB,SAAxB,EAAmCH,aAAnC;AACA,WAAO;AAAA,aAAMX,MAAM,CAACe,mBAAP,CAA2B,SAA3B,EAAsCJ,aAAtC,CAAN;AAAA,KAAP;AACD,GAHQ,EAGN,CAACA,aAAD,CAHM,CAAT;AAKA,SAAO,CAACJ,KAAD,EAAQJ,OAAR,CAAP;AACD;;;;"}