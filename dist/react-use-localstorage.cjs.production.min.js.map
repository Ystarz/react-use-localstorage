{"version":3,"file":"react-use-localstorage.cjs.production.min.js","sources":["../src/index.ts"],"sourcesContent":["import { Dispatch, useCallback, useEffect, useState } from 'react';\n\nconst isJson = (s: any) => {\n  if (!s) return false;\n\n  try {\n    var o = JSON.parse(s);\n    if (o && typeof o === 'object') return true;\n  } catch (e) {}\n\n  return false;\n};\n\nexport default function useLocalStorage(\n  key: string,\n  initialValue: any = ''\n): [any, Dispatch<string>] {\n  if (!window.localStorage.getItem(key)) {\n    if (typeof (initialValue) == 'object')\n      window.localStorage.setItem(key, JSON.stringify(initialValue));\n    else window.localStorage.setItem(key, initialValue);\n  }\n\n  const [value, setValue] = useState(() => {\n    const i = window.localStorage.getItem(key);\n\n    if (i && isJson(i)) return JSON.parse(i);\n    else return i;\n  });\n\n  const setItem = (newValue: any) => {\n    setValue(newValue);\n\n    if (typeof (newValue) == 'object')\n      return window.localStorage.setItem(key, JSON.stringify(newValue));\n    else window.localStorage.setItem(key, newValue);\n  };\n\n  useEffect(() => {\n    const newValue = window.localStorage.getItem(key);\n    if (value !== newValue) {\n      setValue(newValue || initialValue);\n    }\n  });\n\n  const handleStorage = useCallback(\n    (event: StorageEvent) => {\n      if (event.key === key && event.newValue !== value) {\n        setValue(event.newValue || initialValue);\n      }\n    },\n    [value]\n  );\n\n  useEffect(() => {\n    window.addEventListener('storage', handleStorage);\n    return () => window.removeEventListener('storage', handleStorage);\n  }, [handleStorage]);\n\n  return [value, setItem];\n}\n"],"names":["key","initialValue","window","localStorage","getItem","setItem","JSON","stringify","useState","i","s","o","parse","e","isJson","value","setValue","useEffect","newValue","handleStorage","useCallback","event","addEventListener","removeEventListener"],"mappings":"oHAcEA,EACAC,YAAAA,IAAAA,EAAoB,IAEfC,OAAOC,aAAaC,QAAQJ,IAE7BE,OAAOC,aAAaE,QAAQL,EAAKM,KAAKC,UAAUN,UAI1BO,YAAS,eAC3BC,EAAIP,OAAOC,aAAaC,QAAQJ,UAElCS,GAxBO,SAACC,OACTA,EAAG,OAAO,UAGTC,EAAIL,KAAKM,MAAMF,MACfC,GAAkB,iBAANA,EAAgB,OAAO,EACvC,MAAOE,WAEF,EAgBIC,CAAOL,GAAWH,KAAKM,MAAMH,GAC1BA,KAJPM,OAAOC,OAedC,aAAU,eACFC,EAAWhB,OAAOC,aAAaC,QAAQJ,GACzCe,IAAUG,GACZF,EAASE,GAAYjB,UAInBkB,EAAgBC,eACpB,SAACC,GACKA,EAAMrB,MAAQA,GAAOqB,EAAMH,WAAaH,GAC1CC,EAASK,EAAMH,UAAYjB,KAG/B,CAACc,WAGHE,aAAU,kBACRf,OAAOoB,iBAAiB,UAAWH,GAC5B,kBAAMjB,OAAOqB,oBAAoB,UAAWJ,MAClD,CAACA,IAEG,CAACJ,EA7BQ,SAACG,GAIb,OAHFF,EAASE,GAGAhB,OAAOC,aAAaE,QAAQL,EAAKM,KAAKC,UAAUW"}